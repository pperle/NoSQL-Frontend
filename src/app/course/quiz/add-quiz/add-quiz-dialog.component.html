<h1 matDialogTitle>Erstellen Sie einen neuen Test</h1>

<mat-dialog-content>
  <mat-card>
    <mat-card-title>
      <mat-form-field class="full-width">
        <input matInput placeholder="Name des Tests" [formControl]="quiznameFormControl"
               [errorStateMatcher]="quiznameMatcher" [(ngModel)]="quiz.name" (change)="onUpdateQuizTitle($event)">
      </mat-form-field>
    </mat-card-title>

    <mat-card-content>

      <mat-form-field style="width: 49.5%">
        <input matInput [matDatepickerFilter]="notBeforeToday" [matDatepicker]="startDate" placeholder="sichtbar von"
               [(ngModel)]="quiz.visibilityStartDate" (dateChange)="onUpdateVisibilityStartDate($event)" readonly>
        <mat-datepicker-toggle matSuffix [for]="startDate"></mat-datepicker-toggle>
        <mat-datepicker #startDate></mat-datepicker>
      </mat-form-field>
      <mat-form-field style="width: 49.5%">
        <input matInput [matDatepickerFilter]="notBeforeStartDate" [matDatepicker]="endDate" placeholder="sichtbar bis"
               [(ngModel)]="quiz.visibilityEndDate" (dateChange)="onUpdateVisibilityEndDate($event)" readonly>
        <mat-datepicker-toggle matSuffix [for]="endDate"></mat-datepicker-toggle>
        <mat-datepicker #endDate></mat-datepicker>
      </mat-form-field>
    </mat-card-content>


    <mat-card *ngFor="let question of quiz.questions; index as questionIndex">
      <mat-card-title>
        <mat-form-field class="full-width">
          <input matInput placeholder="Frage" [formControl]="questionFormControl"
                 [errorStateMatcher]="questionMatcher" [(ngModel)]="question.questionText"
                 (change)="onUpdateQuestion($event, questionIndex)">
        </mat-form-field>
      </mat-card-title>
      <mat-card-content>
        <span *ngFor="let answer of question.possibleAnwsers; index as answerIndex">
          <mat-checkbox (change)="onUpdateChecked($event, questionIndex, answerIndex)">
            <mat-form-field>
              <input class="answerText" matInput placeholder="Antwort" [formControl]="answerFormControl"
                     [errorStateMatcher]="answerMatcher" value="{{answer}}"
                     (change)="onUpdateAnswer($event, questionIndex, answerIndex)">
            </mat-form-field>
          </mat-checkbox>
        </span>
      </mat-card-content>
      <span class="done" (click)="deleteQuestion(questionIndex)">
            <button mat-fab>
              <mat-icon>delete circle</mat-icon>
            </button>
          </span>
    </mat-card>

    <span class="done" (click)="addQuestion()">
        <button mat-fab>
          <mat-icon>add circle</mat-icon>
        </button>
      </span>

  </mat-card>


</mat-dialog-content>

<mat-dialog-actions>
  <button mat-button color="primary" (click)="onSave()"
          [disabled]="quiznameFormControl.invalid || questionFormControl.invalid || answerFormControl.invalid">
    Test speichern
  </button>
  <!-- Can optionally provide a result for the closing dialog. -->
  <button mat-button color="warn" [mat-dialog-close]="true">Abbrechen</button>
</mat-dialog-actions>

